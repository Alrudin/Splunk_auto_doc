# Sample transforms.conf
# Index-time and search-time transforms

[route_to_index]
REGEX = level=ERROR
DEST_KEY = _MetaData:Index
FORMAT = error_index

[mask_sensitive_data]
REGEX = (password|ssn|credit_card)=(\S+)
FORMAT = $1=***MASKED***
DEST_KEY = _raw

# Sourcetype transformation
[override_sourcetype]
REGEX = .
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::overridden:log

# Field extraction
[extract_special_fields]
REGEX = ^(?P<event_id>\d+)\s+(?P<severity>\w+)
FORMAT = event_id::$1 severity::$2

# Multi-line regex with continuation
[complex_extraction]
REGEX = ^START.*?(?P<transaction_id>[A-Z0-9]{10}).*?\\
(?P<amount>\d+\.\d{2}).*?\\
(?P<status>SUCCESS|FAILURE)
FORMAT = transaction_id::$1 amount::$2 status::$3

# Route by severity
[route_by_severity]
REGEX = severity=(?P<sev>CRITICAL|HIGH)
DEST_KEY = _MetaData:Index
FORMAT = critical_index

[route_by_client]
REGEX = client=(?P<client>\w+)
FORMAT = client::$1

# Repeated definition (last-wins)
[route_to_index]
# This overrides the earlier definition
REGEX = level=(ERROR|CRITICAL)
DEST_KEY = _MetaData:Index
FORMAT = critical_index
